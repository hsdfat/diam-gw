// Diameter S6a/S6d Interface Application
// Based on 3GPP TS 29.272 v16.5.0
// Interface between MME/SGSN and HSS

syntax = "diameter1";

package diameter.s6a;

option go_package = "github.com/hsdfat8/diam-gw/commands/s6a";

// ================================================================================
//                         APPLICATION IDENTIFIER
// ================================================================================
// S6a/S6d Application ID: 16777251 (allocated by IANA)
// Vendor ID: 10415 (3GPP)

const S6A_APPLICATION_ID = 16777251;
const VENDOR_ID_3GPP = 10415;

// ================================================================================
//                         COMMAND CODE VALUES
// ================================================================================
// Table 7.2.2/1: Command-Code values for S6a/S6d

const ULR_COMMAND_CODE = 316;  // Update-Location-Request/Answer
const CLR_COMMAND_CODE = 317;  // Cancel-Location-Request/Answer
const AIR_COMMAND_CODE = 318;  // Authentication-Information-Request/Answer
const IDR_COMMAND_CODE = 319;  // Insert-Subscriber-Data-Request/Answer
const DSR_COMMAND_CODE = 320;  // Delete-Subscriber-Data-Request/Answer
const PUR_COMMAND_CODE = 321;  // Purge-UE-Request/Answer
const RSR_COMMAND_CODE = 322;  // Reset-Request/Answer
const NOR_COMMAND_CODE = 323;  // Notify-Request/Answer

// ================================================================================
//                         ENUMERATED VALUE DEFINITIONS
// ================================================================================

// Cancellation-Type (AVP Code 1420)
enum CancellationType {
  MME_UPDATE_PROCEDURE = 0;
  SGSN_UPDATE_PROCEDURE = 1;
  SUBSCRIPTION_WITHDRAWAL = 2;
  UPDATE_PROCEDURE_IWF = 3;
  INITIAL_ATTACH_PROCEDURE = 4;
}

// Network-Access-Mode (AVP Code 1417)
enum NetworkAccessMode {
  PACKET_AND_CIRCUIT = 0;
  Reserved = 1;
  ONLY_PACKET = 2;
}

// Subscriber-Status (AVP Code 1424)
enum SubscriberStatus {
  SERVICE_GRANTED = 0;
  OPERATOR_DETERMINED_BARRING = 1;
}

// All-APN-Configurations-Included-Indicator (AVP Code 1428)
enum AllAPNConfigurationsIncludedIndicator {
  All_APN_CONFIGURATIONS_INCLUDED = 0;
  MODIFIED_ADDED_APN_CONFIGURATIONS_INCLUDED = 1;
}

// PDN-GW-Allocation-Type (AVP Code 1438)
enum PDNGWAllocationType {
  STATIC = 0;
  DYNAMIC = 1;
}

// VPLMN-Dynamic-Address-Allowed (AVP Code 1432)
enum VPLMNDynamicAddressAllowed {
  NOTALLOWED = 0;
  ALLOWED = 1;
}

// Alert-Reason (AVP Code 1434)
enum AlertReason {
  UE_PRESENT = 0;
  UE_MEMORY_AVAILABLE = 1;
}

// Equipment-Status (AVP Code 1445)
enum EquipmentStatus {
  WHITELISTED = 0;
  BLACKLISTED = 1;
  GREYLISTED = 2;
}

// UE-SRVCC-Capability (AVP Code 1615)
enum UESRVCCCapability {
  UE_SRVCC_NOT_SUPPORTED = 0;
  UE_SRVCC_SUPPORTED = 1;
}

// SMS-Register-Request (AVP Code 1648)
enum SMSRegisterRequest {
  SMS_REGISTRATION_REQUIRED = 0;
  SMS_REGISTRATION_NOT_PREFERRED = 1;
  NO_PREFERENCE = 2;
}

// ================================================================================
//                         BASE PROTOCOL AVP DEFINITIONS
// ================================================================================
// These AVPs are defined in RFC 6733 (Diameter Base Protocol)
// They do NOT have a Vendor-ID (vendor_id is absent or 0)

// User-Name (AVP Code 1)
// Contains the user identifier (IMSI in S6a context)
// RFC 6733 - No Vendor-ID
avp User-Name {
  code = 1;
  type = UTF8String;
  must = true;
  may_encrypt = true;
  description = "User identifier (IMSI when used in S6a context)";
}

// Session-Id (AVP Code 263)
// Identifies the Diameter session
// RFC 6733 - No Vendor-ID
avp Session-Id {
  code = 263;
  type = UTF8String;
  must = true;
  may_encrypt = false;
  description = "Uniquely identifies a Diameter session";
}

// Auth-Session-State (AVP Code 277)
// Specifies whether session state is maintained
// RFC 6733 - No Vendor-ID
avp Auth-Session-State {
  code = 277;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Indicates whether state is maintained for a session";
  // Values:
  //   0 = STATE_MAINTAINED
  //   1 = NO_STATE_MAINTAINED (required for S6a)
}

// Origin-Host (AVP Code 264)
// Identity of the Diameter node that originated the message
// RFC 6733 - No Vendor-ID
avp Origin-Host {
  code = 264;
  type = DiameterIdentity;
  must = true;
  may_encrypt = false;
  description = "Identity of the node that originated the Diameter message";
}

// Origin-Realm (AVP Code 296)
// Realm of the node that originated the message
// RFC 6733 - No Vendor-ID
avp Origin-Realm {
  code = 296;
  type = DiameterIdentity;
  must = true;
  may_encrypt = false;
  description = "Realm of the node that originated the Diameter message";
}

// Destination-Host (AVP Code 293)
// Identity of the Diameter node that should receive the message
// RFC 6733 - No Vendor-ID
avp Destination-Host {
  code = 293;
  type = DiameterIdentity;
  must = true;
  may_encrypt = false;
  description = "Identity of the destination Diameter node";
}

// Destination-Realm (AVP Code 283)
// Realm of the destination node
// RFC 6733 - No Vendor-ID
avp Destination-Realm {
  code = 283;
  type = DiameterIdentity;
  must = true;
  may_encrypt = false;
  description = "Realm of the destination Diameter node";
}

// Result-Code (AVP Code 268)
// Indicates whether a request was successfully completed
// RFC 6733 - No Vendor-ID
avp Result-Code {
  code = 268;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Result of the Diameter request";
  // Common values:
  //   2001 = DIAMETER_SUCCESS
  //   3xxx = Protocol Errors
  //   5xxx = Permanent Failures
}

// Experimental-Result (AVP Code 297)
// Used for vendor-specific result codes
// RFC 6733 - No Vendor-ID
avp Experimental-Result {
  code = 297;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains vendor-specific result information";

  grouped {
    required Vendor-Id vendor_id = 1;                           // Code 266
    required Experimental-Result-Code experimental_result_code = 2; // Code 298
  }
}

// Vendor-Id (AVP Code 266)
// Vendor identifier (10415 for 3GPP)
// RFC 6733 - No Vendor-ID
avp Vendor-Id {
  code = 266;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Vendor identifier (10415 for 3GPP)";
}

// Experimental-Result-Code (AVP Code 298)
// Vendor-specific result code value
// RFC 6733 - No Vendor-ID
avp Experimental-Result-Code {
  code = 298;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Vendor-specific result code";
}

// Vendor-Specific-Application-Id (AVP Code 260)
// Used to advertise vendor-specific Diameter applications
// RFC 6733 - No Vendor-ID
avp Vendor-Specific-Application-Id {
  code = 260;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains vendor-specific application identifier";

  grouped {
    optional Vendor-Id vendor_id = 1;
    optional Auth-Application-Id auth_application_id = 2;
    optional Acct-Application-Id acct_application_id = 3;
  }
}

// Auth-Application-Id (AVP Code 258)
// Authentication and authorization application identifier
// RFC 6733 - No Vendor-ID
avp Auth-Application-Id {
  code = 258;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Authentication application identifier";
}

// Acct-Application-Id (AVP Code 259)
// Accounting application identifier
// RFC 6733 - No Vendor-ID
avp Acct-Application-Id {
  code = 259;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Accounting application identifier";
}

// Failed-AVP (AVP Code 279)
// Contains AVPs that caused a request to fail
// RFC 6733 - No Vendor-ID
avp Failed-AVP {
  code = 279;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains AVPs that could not be processed successfully";

  grouped {
    repeated optional AVP avp = 1;  // Any AVP that failed
  }
}

// Proxy-Info (AVP Code 284)
// Contains state information from a proxy
// RFC 6733 - No Vendor-ID
avp Proxy-Info {
  code = 284;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains proxy state information";

  grouped {
    required Proxy-Host proxy_host = 1;    // Code 280
    optional Proxy-State proxy_state = 2;  // Code 33
  }
}

// Proxy-Host (AVP Code 280)
// Identity of the proxy that added the Proxy-Info AVP
// RFC 6733 - No Vendor-ID
avp Proxy-Host {
  code = 280;
  type = DiameterIdentity;
  must = true;
  may_encrypt = false;
  description = "Identity of the proxy server";
}

// Proxy-State (AVP Code 33)
// State information from a proxy
// RFC 6733 - No Vendor-ID
avp Proxy-State {
  code = 33;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "State information added by a proxy";
}

// Route-Record (AVP Code 282)
// Identity of a node that processed the message
// RFC 6733 - No Vendor-ID
avp Route-Record {
  code = 282;
  type = DiameterIdentity;
  must = true;
  may_encrypt = false;
  description = "Identity of a Diameter node in the path";
}

// DRMP (AVP Code 301)
// Diameter Routing Message Priority
// RFC 7944 - No Vendor-ID
avp DRMP {
  code = 301;
  type = Enumerated;
  must = false;
  may_encrypt = false;
  description = "Diameter Routing Message Priority";
  // Values:
  //   0 = PRIORITY_0 (lowest)
  //   ...
  //   15 = PRIORITY_15 (highest)
}

// ================================================================================
//                         S6a SPECIFIC AVP DEFINITIONS
// ================================================================================
// All S6a-specific AVPs have Vendor-ID = 10415 (3GPP)
// Flag notation: M (Mandatory), V (Vendor-specific)
// All S6a AVPs use M,V flags as per Table 7.3.1/1 in TS 29.272

// Subscription-Data (AVP Code 1400) - Grouped
// Flags: M, V
avp Subscription-Data {
  code = 1400;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains the subscription data for the user";

  grouped {
    optional Subscriber-Status subscriber_status = 1;
    optional MSISDN msisdn = 2;
    optional A-MSISDN a_msisdn = 3;
    optional STN-SR stn_sr = 4;
    optional ICS-Indicator ics_indicator = 5;
    optional Network-Access-Mode network_access_mode = 6;
    optional Operator-Determined-Barring operator_determined_barring = 7;
    optional HPLMN-ODB hplmn_odb = 8;
    repeated Regional-Subscription-Zone-Code regional_subscription_zone_code = 9;
    optional Access-Restriction-Data access_restriction_data = 10;
    optional APN-OI-Replacement apn_oi_replacement = 11;
    optional LCS-Info lcs_info = 12;
    optional Teleservice-List teleservice_list = 13;
    repeated Call-Barring-Info call_barring_info = 14;
    optional 3GPP-Charging-Characteristics charging_characteristics = 15;
    optional AMBR ambr = 16;
    optional APN-Configuration-Profile apn_configuration_profile = 17;
    optional RAT-Frequency-Selection-Priority-ID rat_frequency_selection_priority_id = 18;
    optional Trace-Data trace_data = 19;
    optional GPRS-Subscription-Data gprs_subscription_data = 20;
    repeated CSG-Subscription-Data csg_subscription_data = 21;
    optional Roaming-Restricted-Due-To-Unsupported-Feature roaming_restricted = 22;
    optional Subscribed-Periodic-RAU-TAU-Timer subscribed_periodic_rau_tau_timer = 23;
    optional MPS-Priority mps_priority = 24;
    optional VPLMN-LIPA-Allowed vplmn_lipa_allowed = 25;
    optional Relay-Node-Indicator relay_node_indicator = 26;
    optional MDT-User-Consent mdt_user_consent = 27;
    optional Subscribed-VSRVCC subscribed_vsrvcc = 28;
    optional ProSe-Subscription-Data prose_subscription_data = 29;
    optional Subscription-Data-Flags subscription_data_flags = 30;
    repeated Adjacent-Access-Restriction-Data adjacent_access_restriction_data = 31;
    optional DL-Buffering-Suggested-Packet-Count dl_buffering_suggested_packet_count = 32;
    repeated IMSI-Group-Id imsi_group_id = 33;
    optional UE-Usage-Type ue_usage_type = 34;
    repeated AESE-Communication-Pattern aese_communication_pattern = 35;
    repeated Monitoring-Event-Configuration monitoring_event_configuration = 36;
    optional Emergency-Info emergency_info = 37;
    optional V2X-Subscription-Data v2x_subscription_data = 38;
    optional eDRX-Cycle-Length edrx_cycle_length = 39;
    optional External-Identifier external_identifier = 40;
    optional Active-Time active_time = 41;
    optional Service-Gap-Time service_gap_time = 42;
    optional Broadcast-Location-Assistance-Data-Types broadcast_location_assistance_data_types = 43;
    optional Aerial-UE-Subscription-Information aerial_ue_subscription_information = 44;
    optional Core-Network-Restrictions core_network_restrictions = 45;
  }
}

// Terminal-Information (AVP Code 1401) - Grouped
// Flags: M, V
avp Terminal-Information {
  code = 1401;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains information about the user's mobile equipment";

  grouped {
    optional IMEI imei = 1;                        // Code 1402
    optional 3GPP2-MEID meid = 2;                  // Code 1471
    optional Software-Version software_version = 3; // Code 1403
  }
}

// IMEI (AVP Code 1402)
avp IMEI {
  code = 1402;
  vendor_id = 10415;
  type = UTF8String;
  must = true;
  may_encrypt = false;
  description = "International Mobile Equipment Identity";
}

// Software-Version (AVP Code 1403)
avp Software-Version {
  code = 1403;
  vendor_id = 10415;
  type = UTF8String;
  must = true;
  may_encrypt = false;
  description = "Software version of the mobile equipment";
}

// 3GPP2-MEID (AVP Code 1471)
avp 3GPP2-MEID {
  code = 1471;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Mobile Equipment Identifier for 3GPP2";
}

// ULR-Flags (AVP Code 1405)
avp ULR-Flags {
  code = 1405;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Update Location Request flags";
  // Bit 0: Single-Registration-Indication
  // Bit 1: S6a/S6d-Indicator (0=S6a, 1=S6d)
  // Bit 2: Skip-Subscriber-Data
  // Bit 3: GPRS-Subscription-Data-Indicator
  // Bit 4: Node-Type-Indicator
  // Bit 5: Initial-Attach-Indicator
  // Bit 6: PS-LCS-Not-Supported-By-UE
  // Bit 7: SMS-Only-Indication
}

// ULA-Flags (AVP Code 1406)
avp ULA-Flags {
  code = 1406;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Update Location Answer flags";
  // Bit 0: Separation Indication
  // Bit 1: MME Registered for SMS
}

// Visited-PLMN-Id (AVP Code 1407)
avp Visited-PLMN-Id {
  code = 1407;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "MCC and MNC of the visited PLMN (3 bytes)";
}

// Requested-EUTRAN-Authentication-Info (AVP Code 1408) - Grouped
avp Requested-EUTRAN-Authentication-Info {
  code = 1408;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains E-UTRAN authentication request information";

  grouped {
    optional Number-Of-Requested-Vectors number_of_requested_vectors = 1;  // Code 1410
    optional Immediate-Response-Preferred immediate_response_preferred = 2; // Code 1412
    optional Re-Synchronization-Info re_synchronization_info = 3;          // Code 1411
  }
}

// Requested-UTRAN-GERAN-Authentication-Info (AVP Code 1409) - Grouped
avp Requested-UTRAN-GERAN-Authentication-Info {
  code = 1409;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains UTRAN/GERAN authentication request information";

  grouped {
    optional Number-Of-Requested-Vectors number_of_requested_vectors = 1;
    optional Immediate-Response-Preferred immediate_response_preferred = 2;
    optional Re-Synchronization-Info re_synchronization_info = 3;
  }
}

// Number-Of-Requested-Vectors (AVP Code 1410)
avp Number-Of-Requested-Vectors {
  code = 1410;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Number of authentication vectors requested";
}

// Re-Synchronization-Info (AVP Code 1411)
avp Re-Synchronization-Info {
  code = 1411;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Contains RAND and AUTS for resynchronization";
}

// Immediate-Response-Preferred (AVP Code 1412)
avp Immediate-Response-Preferred {
  code = 1412;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Indicates vectors are needed for immediate use";
}

// Authentication-Info (AVP Code 1413) - Grouped
avp Authentication-Info {
  code = 1413;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains authentication vectors";

  grouped {
    repeated E-UTRAN-Vector e_utran_vector = 1;  // Code 1414
    repeated UTRAN-Vector utran_vector = 2;      // Code 1415
    repeated GERAN-Vector geran_vector = 3;      // Code 1416
  }
}

// E-UTRAN-Vector (AVP Code 1414) - Grouped
avp E-UTRAN-Vector {
  code = 1414;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains E-UTRAN authentication vector";

  grouped {
    optional Item-Number item_number = 1;  // Code 1419
    required RAND rand = 2;                // Code 1447
    required XRES xres = 3;                // Code 1448
    required AUTN autn = 4;                // Code 1449
    required KASME kasme = 5;              // Code 1450
  }
}

// UTRAN-Vector (AVP Code 1415) - Grouped
avp UTRAN-Vector {
  code = 1415;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains UTRAN authentication vector";

  grouped {
    optional Item-Number item_number = 1;
    required RAND rand = 2;
    required XRES xres = 3;
    required AUTN autn = 4;
    required Confidentiality-Key ck = 5;   // Code 1451
    required Integrity-Key ik = 6;          // Code 1452
  }
}

// GERAN-Vector (AVP Code 1416) - Grouped
avp GERAN-Vector {
  code = 1416;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains GERAN authentication vector";

  grouped {
    optional Item-Number item_number = 1;
    required RAND rand = 2;
    required SRES sres = 3;                // Code 1454
    required Kc kc = 4;                    // Code 1453
  }
}

// Item-Number (AVP Code 1419)
avp Item-Number {
  code = 1419;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Ordering number for multiple vectors";
}

// RAND (AVP Code 1447)
avp RAND {
  code = 1447;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Random challenge (16 bytes)";
}

// XRES (AVP Code 1448)
avp XRES {
  code = 1448;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Expected response";
}

// AUTN (AVP Code 1449)
avp AUTN {
  code = 1449;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Authentication token (16 bytes)";
}

// KASME (AVP Code 1450)
avp KASME {
  code = 1450;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Key for E-UTRAN (32 bytes)";
}

// Confidentiality-Key (AVP Code 1451)
avp Confidentiality-Key {
  code = 1451;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Ciphering key CK (16 bytes)";
}

// Integrity-Key (AVP Code 1452)
avp Integrity-Key {
  code = 1452;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Integrity key IK (16 bytes)";
}

// Kc (AVP Code 1453)
avp Kc {
  code = 1453;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "GERAN ciphering key (8 bytes)";
}

// SRES (AVP Code 1454)
avp SRES {
  code = 1454;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Signed response (4 bytes)";
}

// Cancellation-Type (AVP Code 1420)
avp Cancellation-Type {
  code = 1420;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Reason for cancel location";
}

// DSR-Flags (AVP Code 1421)
avp DSR-Flags {
  code = 1421;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Delete Subscriber Data Request flags";
  // Bit 0: Regional Subscription Withdrawal
  // Bit 1: Complete APN Configuration Profile Withdrawal
  // Bit 2: Subscribed Charging Characteristics Withdrawal
  // Bit 3: PDN subscription contexts Withdrawal
  // Bit 4: STN-SR
  // Bit 5: Complete PDP context list Withdrawal
  // Bit 6: PDP contexts Withdrawal
  // Bit 7: Roaming Restricted Due To Unsupported Feature
  // Bit 8: Trace Data Withdrawal
  // Bit 9: CSG Deleted
  // Bit 10: APN-OI-Replacement
  // ...more bits defined
}

// DSA-Flags (AVP Code 1422)
avp DSA-Flags {
  code = 1422;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Delete Subscriber Data Answer flags";
}

// Context-Identifier (AVP Code 1423)
avp Context-Identifier {
  code = 1423;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Identifies an APN Configuration";
}

// Subscriber-Status (AVP Code 1424)
avp Subscriber-Status {
  code = 1424;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Status of the subscriber";
}

// Operator-Determined-Barring (AVP Code 1425)
avp Operator-Determined-Barring {
  code = 1425;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask of barring categories";
}

// Access-Restriction-Data (AVP Code 1426)
avp Access-Restriction-Data {
  code = 1426;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask of access restrictions";
}

// APN-OI-Replacement (AVP Code 1427)
avp APN-OI-Replacement {
  code = 1427;
  vendor_id = 10415;
  type = UTF8String;
  must = true;
  may_encrypt = false;
  description = "APN Operator Identifier replacement";
}

// All-APN-Configurations-Included-Indicator (AVP Code 1428)
avp All-APN-Configurations-Included-Indicator {
  code = 1428;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Indicates if all APNs are included";
}

// APN-Configuration-Profile (AVP Code 1429) - Grouped
avp APN-Configuration-Profile {
  code = 1429;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains APN configurations";

  grouped {
    required Context-Identifier context_identifier = 1;
    required All-APN-Configurations-Included-Indicator all_apn_config_included = 2;
    repeated APN-Configuration apn_configuration = 3;
  }
}

// APN-Configuration (AVP Code 1430) - Grouped
avp APN-Configuration {
  code = 1430;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains single APN configuration";

  grouped {
    required Context-Identifier context_identifier = 1;
    repeated Served-Party-IP-Address served_party_ip_address = 2;
    required PDN-Type pdn_type = 3;
    required Service-Selection service_selection = 4;
    optional EPS-Subscribed-QoS-Profile eps_subscribed_qos_profile = 5;
    optional VPLMN-Dynamic-Address-Allowed vplmn_dynamic_address_allowed = 6;
    optional MIP6-Agent-Info mip6_agent_info = 7;
    optional Visited-Network-Identifier visited_network_identifier = 8;
    optional PDN-GW-Allocation-Type pdn_gw_allocation_type = 9;
    optional 3GPP-Charging-Characteristics charging_characteristics = 10;
    optional AMBR ambr = 11;
    repeated Specific-APN-Info specific_apn_info = 12;
    optional APN-OI-Replacement apn_oi_replacement = 13;
    optional SIPTO-Permission sipto_permission = 14;
    optional LIPA-Permission lipa_permission = 15;
    optional Restoration-Priority restoration_priority = 16;
    optional SIPTO-Local-Network-Permission sipto_local_network_permission = 17;
    optional WLAN-offloadability wlan_offloadability = 18;
    optional Non-IP-PDN-Type-Indicator non_ip_pdn_type_indicator = 19;
    optional Non-IP-Data-Delivery-Mechanism non_ip_data_delivery_mechanism = 20;
    optional SCEF-ID scef_id = 21;
    optional SCEF-Realm scef_realm = 22;
    optional Preferred-Data-Mode preferred_data_mode = 23;
    optional PDN-Connection-Continuity pdn_connection_continuity = 24;
  }
}

// EPS-Subscribed-QoS-Profile (AVP Code 1431) - Grouped
avp EPS-Subscribed-QoS-Profile {
  code = 1431;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains subscribed QoS profile for EPS";

  grouped {
    required QoS-Class-Identifier qos_class_identifier = 1;
    required Allocation-Retention-Priority allocation_retention_priority = 2;
  }
}

// AMBR (AVP Code 1435) - Grouped
avp AMBR {
  code = 1435;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Aggregate Maximum Bit Rate";

  grouped {
    required Max-Requested-Bandwidth-UL max_requested_bandwidth_ul = 1;
    required Max-Requested-Bandwidth-DL max_requested_bandwidth_dl = 2;
    optional Extended-Max-Requested-BW-UL extended_max_requested_bw_ul = 3;
    optional Extended-Max-Requested-BW-DL extended_max_requested_bw_dl = 4;
  }
}

// CSG-Subscription-Data (AVP Code 1436) - Grouped
avp CSG-Subscription-Data {
  code = 1436;
  vendor_id = 10415;
  type = Grouped;
  must = true;
  may_encrypt = false;
  description = "Contains CSG subscription data";

  grouped {
    required CSG-Id csg_id = 1;
    optional Expiration-Date expiration_date = 2;
    repeated Service-Selection service_selection = 3;
    optional Visited-PLMN-Id visited_plmn_id = 4;
  }
}

// RAT-Type (AVP Code 1032) - from 3GPP TS 29.212
avp RAT-Type {
  code = 1032;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Radio Access Technology type";
}

// IDA-Flags (AVP Code 1441)
avp IDA-Flags {
  code = 1441;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Insert Subscriber Data Answer flags";
}

// PUA-Flags (AVP Code 1442)
avp PUA-Flags {
  code = 1442;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Purge UE Answer flags";
  // Bit 0: Freeze M-TMSI
  // Bit 1: Freeze P-TMSI
}

// NOR-Flags (AVP Code 1443)
avp NOR-Flags {
  code = 1443;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Notify Request flags";
  // Bit 0: Single-Registration-Indication
  // Bit 1: SGSN area restricted
  // Bit 2: Ready for SM
  // Bit 3: UE Reachable
  // Bit 4: Homogeneous Support of IMS Voice Over PS Sessions
  // Bit 5: S6a/S6d-Indicator
  // Bit 6: Removal of MME Registration for SMS
}

// Equipment-Status (AVP Code 1445)
avp Equipment-Status {
  code = 1445;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Status of the mobile equipment";
}

// SGSN-Number (AVP Code 1489)
avp SGSN-Number {
  code = 1489;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "ISDN number of the SGSN";
}

// IDR-Flags (AVP Code 1490)
avp IDR-Flags {
  code = 1490;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Insert Subscriber Data Request flags";
}

// PUR-Flags (AVP Code 1635)
avp PUR-Flags {
  code = 1635;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Purge UE Request flags";
}

// CLR-Flags (AVP Code 1638)
avp CLR-Flags {
  code = 1638;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Cancel Location Request flags";
  // Bit 0: S6a/S6d-Indicator
  // Bit 1: Reattach-Required
}

// AIR-Flags (AVP Code 1679)
avp AIR-Flags {
  code = 1679;
  vendor_id = 10415;
  type = Unsigned32;
  must = true;
  may_encrypt = false;
  description = "Bit mask for Authentication Information Request flags";
  // Bit 0: Send UE Usage Type
}

// MSISDN (AVP Code 701) - from 3GPP TS 29.329
avp MSISDN {
  code = 701;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Mobile Subscriber ISDN Number";
}

// A-MSISDN (AVP Code 1643) - from 3GPP TS 29.329
avp A-MSISDN {
  code = 1643;
  vendor_id = 10415;
  type = OctetString;
  must = true;
  may_encrypt = false;
  description = "Mobile Subscriber ISDN Number";
}

// Service-Selection (AVP Code from RFC 5778)
avp Service-Selection {
  code = 493;
  type = UTF8String;
  must = true;
  may_encrypt = false;
  description = "APN name";
}

// Alert-Reason (AVP Code 1434)
avp Alert-Reason {
  code = 1434;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Reason for alerting HSS";
}

// UE-SRVCC-Capability (AVP Code 1615)
avp UE-SRVCC-Capability {
  code = 1615;
  vendor_id = 10415;
  type = Enumerated;
  must = true;
  may_encrypt = false;
  description = "Indicates if UE supports SRVCC";
}

// Error-Diagnostic (AVP Code 1614)
avp Error-Diagnostic {
  code = 1614;
  vendor_id = 10415;
  type = Enumerated;
  must = false;
  may_encrypt = false;
  description = "Additional error diagnostic information";
}

// ================================================================================
//                         COMMAND DEFINITIONS
// ================================================================================

// ================================================================================
// Update-Location-Request (ULR) - Command Code 316
// 3GPP TS 29.272 Section 7.2.3
// Sent from MME/SGSN to HSS
// ================================================================================
command Update-Location-Request {
  code = 316;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Request to update user location in HSS";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Realm destination_realm = 5;
  fixed required User-Name user_name = 6;              // IMSI
  fixed required RAT-Type rat_type = 7;
  fixed required ULR-Flags ulr_flags = 8;
  fixed required Visited-PLMN-Id visited_plmn_id = 9;

  // Optional AVPs
  optional DRMP drmp = 10;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 11;
  optional Destination-Host destination_host = 12;
  optional OC-Supported-Features oc_supported_features = 13;
  repeated optional Supported-Features supported_features = 14;
  optional Terminal-Information terminal_information = 15;
  optional UE-SRVCC-Capability ue_srvcc_capability = 16;
  optional SGSN-Number sgsn_number = 17;
  optional Homogeneous-Support-of-IMS-Voice-Over-PS-Sessions homogeneous_support_ims_voice = 18;
  optional GMLC-Address gmlc_address = 19;
  repeated optional Active-APN active_apn = 20;
  optional Equivalent-PLMN-List equivalent_plmn_list = 21;
  optional MME-Number-for-MT-SMS mme_number_for_mt_sms = 22;
  optional SMS-Register-Request sms_register_request = 23;
  optional SGs-MME-Identity sgs_mme_identity = 24;
  optional Coupled-Node-Diameter-ID coupled_node_diameter_id = 25;
  optional Adjacent-PLMNs adjacent_plmns = 26;
  optional Supported-Services supported_services = 27;
  repeated optional AVP avp = 28;
  repeated optional Proxy-Info proxy_info = 29;
  repeated optional Route-Record route_record = 30;
}

// ================================================================================
// Update-Location-Answer (ULA) - Command Code 316
// 3GPP TS 29.272 Section 7.2.4
// Sent from HSS to MME/SGSN
// ================================================================================
command Update-Location-Answer {
  code = 316;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Update Location Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Conditional/Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  optional Result-Code result_code = 7;
  optional Experimental-Result experimental_result = 8;
  optional Error-Diagnostic error_diagnostic = 9;
  optional OC-Supported-Features oc_supported_features = 10;
  optional OC-OLR oc_olr = 11;
  repeated optional Load load = 12;
  repeated optional Supported-Features supported_features = 13;
  optional ULA-Flags ula_flags = 14;
  optional Subscription-Data subscription_data = 15;
  repeated optional Reset-ID reset_id = 16;
  repeated optional AVP avp = 17;
  optional Failed-AVP failed_avp = 18;
  repeated optional Proxy-Info proxy_info = 19;
  repeated optional Route-Record route_record = 20;
}

// ================================================================================
// Authentication-Information-Request (AIR) - Command Code 318
// 3GPP TS 29.272 Section 7.2.5
// Sent from MME/SGSN to HSS
// ================================================================================
command Authentication-Information-Request {
  code = 318;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Request authentication vectors from HSS";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Realm destination_realm = 5;
  fixed required User-Name user_name = 6;              // IMSI
  fixed required Visited-PLMN-Id visited_plmn_id = 7;

  // Optional AVPs
  optional DRMP drmp = 8;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 9;
  optional Destination-Host destination_host = 10;
  optional OC-Supported-Features oc_supported_features = 11;
  repeated optional Supported-Features supported_features = 12;
  optional Requested-EUTRAN-Authentication-Info requested_eutran_authentication_info = 13;
  optional Requested-UTRAN-GERAN-Authentication-Info requested_utran_geran_authentication_info = 14;
  optional AIR-Flags air_flags = 15;
  repeated optional AVP avp = 16;
  repeated optional Proxy-Info proxy_info = 17;
  repeated optional Route-Record route_record = 18;
}

// ================================================================================
// Authentication-Information-Answer (AIA) - Command Code 318
// 3GPP TS 29.272 Section 7.2.6
// Sent from HSS to MME/SGSN
// ================================================================================
command Authentication-Information-Answer {
  code = 318;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response with authentication vectors";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Conditional/Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  optional Result-Code result_code = 7;
  optional Experimental-Result experimental_result = 8;
  optional Error-Diagnostic error_diagnostic = 9;
  optional OC-Supported-Features oc_supported_features = 10;
  optional OC-OLR oc_olr = 11;
  repeated optional Load load = 12;
  repeated optional Supported-Features supported_features = 13;
  optional Authentication-Info authentication_info = 14;
  optional UE-Usage-Type ue_usage_type = 15;
  repeated optional AVP avp = 16;
  optional Failed-AVP failed_avp = 17;
  repeated optional Proxy-Info proxy_info = 18;
  repeated optional Route-Record route_record = 19;
}

// ================================================================================
// Cancel-Location-Request (CLR) - Command Code 317
// 3GPP TS 29.272 Section 7.2.7
// Sent from HSS to MME/SGSN
// ================================================================================
command Cancel-Location-Request {
  code = 317;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Request to cancel user location";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Host destination_host = 5;
  fixed required Destination-Realm destination_realm = 6;
  fixed required User-Name user_name = 7;
  fixed required Cancellation-Type cancellation_type = 8;

  // Optional AVPs
  optional DRMP drmp = 9;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 10;
  repeated optional Supported-Features supported_features = 11;
  optional CLR-Flags clr_flags = 12;
  repeated optional AVP avp = 13;
  repeated optional Proxy-Info proxy_info = 14;
  repeated optional Route-Record route_record = 15;
}

// ================================================================================
// Cancel-Location-Answer (CLA) - Command Code 317
// 3GPP TS 29.272 Section 7.2.8
// Sent from MME/SGSN to HSS
// ================================================================================
command Cancel-Location-Answer {
  code = 317;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Cancel Location Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  repeated optional Supported-Features supported_features = 7;
  optional Result-Code result_code = 8;
  optional Experimental-Result experimental_result = 9;
  repeated optional AVP avp = 10;
  optional Failed-AVP failed_avp = 11;
  repeated optional Proxy-Info proxy_info = 12;
  repeated optional Route-Record route_record = 13;
}

// ================================================================================
// Insert-Subscriber-Data-Request (IDR) - Command Code 319
// 3GPP TS 29.272 Section 7.2.9
// Sent from HSS to MME/SGSN
// ================================================================================
command Insert-Subscriber-Data-Request {
  code = 319;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Request to insert/update subscriber data";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Host destination_host = 5;
  fixed required Destination-Realm destination_realm = 6;
  fixed required User-Name user_name = 7;
  fixed required Subscription-Data subscription_data = 8;

  // Optional AVPs
  optional DRMP drmp = 9;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 10;
  repeated optional Supported-Features supported_features = 11;
  optional IDR-Flags idr_flags = 12;
  repeated optional Reset-ID reset_id = 13;
  repeated optional AVP avp = 14;
  repeated optional Proxy-Info proxy_info = 15;
  repeated optional Route-Record route_record = 16;
}

// ================================================================================
// Insert-Subscriber-Data-Answer (IDA) - Command Code 319
// 3GPP TS 29.272 Section 7.2.10
// Sent from MME/SGSN to HSS
// ================================================================================
command Insert-Subscriber-Data-Answer {
  code = 319;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Insert Subscriber Data Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  repeated optional Supported-Features supported_features = 7;
  optional Result-Code result_code = 8;
  optional Experimental-Result experimental_result = 9;
  optional IMS-Voice-Over-PS-Sessions-Supported ims_voice_over_ps_sessions_supported = 10;
  optional Last-UE-Activity-Time last_ue_activity_time = 11;
  optional RAT-Type rat_type = 12;
  optional IDA-Flags ida_flags = 13;
  optional EPS-User-State eps_user_state = 14;
  optional EPS-Location-Information eps_location_information = 15;
  optional Local-Time-Zone local_time_zone = 16;
  optional Supported-Services supported_services = 17;
  repeated optional Monitoring-Event-Report monitoring_event_report = 18;
  repeated optional Monitoring-Event-Config-Status monitoring_event_config_status = 19;
  repeated optional AVP avp = 20;
  optional Failed-AVP failed_avp = 21;
  repeated optional Proxy-Info proxy_info = 22;
  repeated optional Route-Record route_record = 23;
}

// ================================================================================
// Delete-Subscriber-Data-Request (DSR) - Command Code 320
// 3GPP TS 29.272 Section 7.2.11
// Sent from HSS to MME/SGSN
// ================================================================================
command Delete-Subscriber-Data-Request {
  code = 320;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Request to delete subscriber data";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Host destination_host = 5;
  fixed required Destination-Realm destination_realm = 6;
  fixed required User-Name user_name = 7;
  fixed required DSR-Flags dsr_flags = 8;

  // Optional AVPs
  optional DRMP drmp = 9;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 10;
  repeated optional Supported-Features supported_features = 11;
  optional SCEF-ID scef_id = 12;
  repeated optional Context-Identifier context_identifier = 13;
  optional Trace-Reference trace_reference = 14;
  repeated optional TS-Code ts_code = 15;
  repeated optional SS-Code ss_code = 16;
  optional eDRX-Related-RAT edrx_related_rat = 17;
  repeated optional External-Identifier external_identifier = 18;
  repeated optional AVP avp = 19;
  repeated optional Proxy-Info proxy_info = 20;
  repeated optional Route-Record route_record = 21;
}

// ================================================================================
// Delete-Subscriber-Data-Answer (DSA) - Command Code 320
// 3GPP TS 29.272 Section 7.2.12
// Sent from MME/SGSN to HSS
// ================================================================================
command Delete-Subscriber-Data-Answer {
  code = 320;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Delete Subscriber Data Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  repeated optional Supported-Features supported_features = 7;
  optional Result-Code result_code = 8;
  optional Experimental-Result experimental_result = 9;
  optional DSA-Flags dsa_flags = 10;
  repeated optional AVP avp = 11;
  optional Failed-AVP failed_avp = 12;
  repeated optional Proxy-Info proxy_info = 13;
  repeated optional Route-Record route_record = 14;
}

// ================================================================================
// Purge-UE-Request (PUR) - Command Code 321
// 3GPP TS 29.272 Section 7.2.13
// Sent from MME/SGSN to HSS
// ================================================================================
command Purge-UE-Request {
  code = 321;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Request to purge UE from HSS";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Realm destination_realm = 5;
  fixed required User-Name user_name = 6;

  // Optional AVPs
  optional DRMP drmp = 7;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 8;
  optional Destination-Host destination_host = 9;
  optional OC-Supported-Features oc_supported_features = 10;
  optional PUR-Flags pur_flags = 11;
  repeated optional Supported-Features supported_features = 12;
  optional EPS-Location-Information eps_location_information = 13;
  repeated optional AVP avp = 14;
  repeated optional Proxy-Info proxy_info = 15;
  repeated optional Route-Record route_record = 16;
}

// ================================================================================
// Purge-UE-Answer (PUA) - Command Code 321
// 3GPP TS 29.272 Section 7.2.14
// Sent from HSS to MME/SGSN
// ================================================================================
command Purge-UE-Answer {
  code = 321;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Purge UE Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  repeated optional Supported-Features supported_features = 7;
  optional Result-Code result_code = 8;
  optional Experimental-Result experimental_result = 9;
  optional OC-Supported-Features oc_supported_features = 10;
  optional OC-OLR oc_olr = 11;
  repeated optional Load load = 12;
  optional PUA-Flags pua_flags = 13;
  repeated optional AVP avp = 14;
  optional Failed-AVP failed_avp = 15;
  repeated optional Proxy-Info proxy_info = 16;
  repeated optional Route-Record route_record = 17;
}

// ================================================================================
// Reset-Request (RSR) - Command Code 322
// 3GPP TS 29.272 Section 7.2.15
// Sent from HSS to MME/SGSN
// ================================================================================
command Reset-Request {
  code = 322;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Notification of HSS restart";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Host destination_host = 5;
  fixed required Destination-Realm destination_realm = 6;

  // Optional AVPs
  optional DRMP drmp = 7;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 8;
  repeated optional Supported-Features supported_features = 9;
  repeated optional User-Id user_id = 10;
  repeated optional Reset-ID reset_id = 11;
  optional Subscription-Data subscription_data = 12;
  optional Subscription-Data-Deletion subscription_data_deletion = 13;
  repeated optional AVP avp = 14;
  repeated optional Proxy-Info proxy_info = 15;
  repeated optional Route-Record route_record = 16;
}

// ================================================================================
// Reset-Answer (RSA) - Command Code 322
// 3GPP TS 29.272 Section 7.2.16
// Sent from MME/SGSN to HSS
// ================================================================================
command Reset-Answer {
  code = 322;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Reset Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  repeated optional Supported-Features supported_features = 7;
  optional Result-Code result_code = 8;
  optional Experimental-Result experimental_result = 9;
  repeated optional AVP avp = 10;
  optional Failed-AVP failed_avp = 11;
  repeated optional Proxy-Info proxy_info = 12;
  repeated optional Route-Record route_record = 13;
}

// ================================================================================
// Notify-Request (NOR) - Command Code 323
// 3GPP TS 29.272 Section 7.2.17
// Sent from MME/SGSN to HSS
// ================================================================================
command Notify-Request {
  code = 323;
  application_id = 16777251;
  request = true;
  proxiable = true;
  description = "Notification to HSS about various events";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;
  fixed required Destination-Realm destination_realm = 5;
  fixed required User-Name user_name = 6;

  // Optional AVPs
  optional DRMP drmp = 7;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 8;
  optional Destination-Host destination_host = 9;
  optional OC-Supported-Features oc_supported_features = 10;
  repeated optional Supported-Features supported_features = 11;
  optional Terminal-Information terminal_information = 12;
  optional MIP6-Agent-Info mip6_agent_info = 13;
  optional Visited-Network-Identifier visited_network_identifier = 14;
  optional Context-Identifier context_identifier = 15;
  optional Service-Selection service_selection = 16;
  optional Alert-Reason alert_reason = 17;
  optional UE-SRVCC-Capability ue_srvcc_capability = 18;
  optional NOR-Flags nor_flags = 19;
  optional Homogeneous-Support-of-IMS-Voice-Over-PS-Sessions homogeneous_support_ims_voice = 20;
  optional Maximum-UE-Availability-Time maximum_ue_availability_time = 21;
  repeated optional Monitoring-Event-Config-Status monitoring_event_config_status = 22;
  optional Emergency-Services emergency_services = 23;
  repeated optional AVP avp = 24;
  repeated optional Proxy-Info proxy_info = 25;
  repeated optional Route-Record route_record = 26;
}

// ================================================================================
// Notify-Answer (NOA) - Command Code 323
// 3GPP TS 29.272 Section 7.2.18
// Sent from HSS to MME/SGSN
// ================================================================================
command Notify-Answer {
  code = 323;
  application_id = 16777251;
  request = false;
  proxiable = true;
  description = "Response to Notify Request";

  // Required AVPs
  fixed required Session-Id session_id = 1;
  fixed required Auth-Session-State auth_session_state = 2;
  fixed required Origin-Host origin_host = 3;
  fixed required Origin-Realm origin_realm = 4;

  // Optional AVPs
  optional DRMP drmp = 5;
  optional Vendor-Specific-Application-Id vendor_specific_application_id = 6;
  optional Result-Code result_code = 7;
  optional Experimental-Result experimental_result = 8;
  optional OC-Supported-Features oc_supported_features = 9;
  optional OC-OLR oc_olr = 10;
  repeated optional Load load = 11;
  repeated optional Supported-Features supported_features = 12;
  repeated optional AVP avp = 13;
  optional Failed-AVP failed_avp = 14;
  repeated optional Proxy-Info proxy_info = 15;
  repeated optional Route-Record route_record = 16;
}

// ================================================================================
//                         GROUPED AVP STRUCTURE SUMMARY
// ================================================================================
//
// Subscription-Data (1400):
//   +-- Subscriber-Status (1424)
//   +-- MSISDN (701)
//   +-- Network-Access-Mode (1417)
//   +-- Operator-Determined-Barring (1425)
//   +-- HPLMN-ODB (1418)
//   +-- Access-Restriction-Data (1426)
//   +-- APN-OI-Replacement (1427)
//   +-- AMBR (1435)
//   +-- APN-Configuration-Profile (1429)
//   +-- RAT-Frequency-Selection-Priority-ID (1440)
//   +-- *CSG-Subscription-Data (1436)
//   +-- ...many more optional AVPs
//
// Terminal-Information (1401):
//   +-- IMEI (1402)
//   +-- 3GPP2-MEID (1471)
//   +-- Software-Version (1403)
//
// Requested-EUTRAN-Authentication-Info (1408):
//   +-- Number-Of-Requested-Vectors (1410)
//   +-- Immediate-Response-Preferred (1412)
//   +-- Re-Synchronization-Info (1411)
//
// Authentication-Info (1413):
//   +-- *E-UTRAN-Vector (1414)
//   +-- *UTRAN-Vector (1415)
//   +-- *GERAN-Vector (1416)
//
// E-UTRAN-Vector (1414):
//   +-- Item-Number (1419)
//   +-- RAND (1447)
//   +-- XRES (1448)
//   +-- AUTN (1449)
//   +-- KASME (1450)
//
// AMBR (1435):
//   +-- Max-Requested-Bandwidth-UL (516)
//   +-- Max-Requested-Bandwidth-DL (515)
//
// APN-Configuration-Profile (1429):
//   +-- Context-Identifier (1423)
//   +-- All-APN-Configurations-Included-Indicator (1428)
//   +-- *APN-Configuration (1430)
//
// APN-Configuration (1430):
//   +-- Context-Identifier (1423)
//   +-- PDN-Type (1456)
//   +-- Service-Selection (493)
//   +-- EPS-Subscribed-QoS-Profile (1431)
//   +-- VPLMN-Dynamic-Address-Allowed (1432)
//   +-- MIP6-Agent-Info (486)
//   +-- PDN-GW-Allocation-Type (1438)
//   +-- AMBR (1435)
//   +-- ...more optional AVPs
//
// ================================================================================
//                         AVP VENDOR-ID SUMMARY
// ================================================================================
//
// S6a-SPECIFIC AVPs (Vendor-ID = 10415 / 3GPP):
// -----------------------------------------------
//   Subscription-Data                    (1400) - Grouped      - M,V flags
//   Terminal-Information                 (1401) - Grouped      - M,V flags
//   IMEI                                 (1402) - UTF8String   - M,V flags
//   Software-Version                     (1403) - UTF8String   - M,V flags
//   ULR-Flags                            (1405) - Unsigned32   - M,V flags
//   ULA-Flags                            (1406) - Unsigned32   - M,V flags
//   Visited-PLMN-Id                      (1407) - OctetString  - M,V flags
//   Requested-EUTRAN-Authentication-Info (1408) - Grouped      - M,V flags
//   Requested-UTRAN-GERAN-Auth-Info      (1409) - Grouped      - M,V flags
//   Number-Of-Requested-Vectors          (1410) - Unsigned32   - M,V flags
//   Re-Synchronization-Info              (1411) - OctetString  - M,V flags
//   Immediate-Response-Preferred         (1412) - Unsigned32   - M,V flags
//   Authentication-Info                  (1413) - Grouped      - M,V flags
//   E-UTRAN-Vector                       (1414) - Grouped      - M,V flags
//   UTRAN-Vector                         (1415) - Grouped      - M,V flags
//   GERAN-Vector                         (1416) - Grouped      - M,V flags
//   Network-Access-Mode                  (1417) - Enumerated   - M,V flags
//   HPLMN-ODB                            (1418) - Unsigned32   - M,V flags
//   Item-Number                          (1419) - Unsigned32   - M,V flags
//   Cancellation-Type                    (1420) - Enumerated   - M,V flags
//   DSR-Flags                            (1421) - Unsigned32   - M,V flags
//   DSA-Flags                            (1422) - Unsigned32   - M,V flags
//   Context-Identifier                   (1423) - Unsigned32   - M,V flags
//   Subscriber-Status                    (1424) - Enumerated   - M,V flags
//   Operator-Determined-Barring          (1425) - Unsigned32   - M,V flags
//   Access-Restriction-Data              (1426) - Unsigned32   - M,V flags
//   APN-OI-Replacement                   (1427) - UTF8String   - M,V flags
//   All-APN-Configurations-Inc-Indicator (1428) - Enumerated   - M,V flags
//   APN-Configuration-Profile            (1429) - Grouped      - M,V flags
//   APN-Configuration                    (1430) - Grouped      - M,V flags
//   EPS-Subscribed-QoS-Profile           (1431) - Grouped      - M,V flags
//   VPLMN-Dynamic-Address-Allowed        (1432) - Enumerated   - M,V flags
//   STN-SR                               (1433) - OctetString  - M,V flags
//   Alert-Reason                         (1434) - Enumerated   - M,V flags
//   AMBR                                 (1435) - Grouped      - M,V flags
//   CSG-Subscription-Data                (1436) - Grouped      - M,V flags
//   CSG-Id                               (1437) - Unsigned32   - M,V flags
//   PDN-GW-Allocation-Type               (1438) - Enumerated   - M,V flags
//   Expiration-Date                      (1439) - Time         - M,V flags
//   RAT-Frequency-Selection-Priority-ID  (1440) - Unsigned32   - M,V flags
//   IDA-Flags                            (1441) - Unsigned32   - M,V flags
//   PUA-Flags                            (1442) - Unsigned32   - M,V flags
//   NOR-Flags                            (1443) - Unsigned32   - M,V flags
//   User-Id                              (1444) - UTF8String   - M,V flags
//   Equipment-Status                     (1445) - Enumerated   - M,V flags
//   Regional-Subscription-Zone-Code      (1446) - OctetString  - M,V flags
//   RAND                                 (1447) - OctetString  - M,V flags
//   XRES                                 (1448) - OctetString  - M,V flags
//   AUTN                                 (1449) - OctetString  - M,V flags
//   KASME                                (1450) - OctetString  - M,V flags
//   Confidentiality-Key                  (1451) - OctetString  - M,V flags
//   Integrity-Key                        (1452) - OctetString  - M,V flags
//   Kc                                   (1453) - OctetString  - M,V flags
//   SRES                                 (1454) - OctetString  - M,V flags
//   PDN-Type                             (1456) - Enumerated   - M,V flags
//   Roaming-Restricted-Due-To-Unsup-Feat (1457) - Enumerated   - M,V flags
//   3GPP2-MEID                           (1471) - OctetString  - M,V flags
//   SGSN-Number                          (1489) - OctetString  - M,V flags
//   IDR-Flags                            (1490) - Unsigned32   - M,V flags
//   UE-SRVCC-Capability                  (1615) - Enumerated   - M,V flags
//   Error-Diagnostic                     (1614) - Enumerated   - M,V flags (optional)
//   PUR-Flags                            (1635) - Unsigned32   - M,V flags
//   CLR-Flags                            (1638) - Unsigned32   - M,V flags
//   A-MSISDN                             (1643) - OctetString  - M,V flags
//   SMS-Register-Request                 (1648) - Enumerated   - M,V flags
//   AIR-Flags                            (1679) - Unsigned32   - M,V flags
//   MSISDN                               (701)  - OctetString  - M,V flags
//   RAT-Type                             (1032) - Enumerated   - M,V flags
//   ... and many more S6a-specific AVPs
//
// BASE PROTOCOL AVPs (No Vendor-ID / RFC 6733):
// -----------------------------------------------
//   User-Name                 (1)     - UTF8String
//   Proxy-State               (33)    - OctetString
//   Auth-Application-Id       (258)   - Unsigned32
//   Acct-Application-Id       (259)   - Unsigned32
//   Vendor-Specific-App-Id    (260)   - Grouped
//   Session-Id                (263)   - UTF8String
//   Origin-Host               (264)   - DiameterIdentity
//   Vendor-Id                 (266)   - Unsigned32
//   Result-Code               (268)   - Unsigned32
//   Auth-Session-State        (277)   - Enumerated
//   Failed-AVP                (279)   - Grouped
//   Proxy-Host                (280)   - DiameterIdentity
//   Route-Record              (282)   - DiameterIdentity
//   Destination-Realm         (283)   - DiameterIdentity
//   Proxy-Info                (284)   - Grouped
//   Destination-Host          (293)   - DiameterIdentity
//   Origin-Realm              (296)   - DiameterIdentity
//   Experimental-Result       (297)   - Grouped
//   Experimental-Result-Code  (298)   - Unsigned32
//   DRMP                      (301)   - Enumerated (RFC 7944)
//
// OTHER PROTOCOL AVPs (RFC 5778):
// -----------------------------------------------
//   Service-Selection         (493)   - UTF8String (No Vendor-ID)
//
// ================================================================================
//                         RELATED SPECIFICATIONS
// ================================================================================
//
// - 3GPP TS 29.272: S6a/S6d and S13/S13' interface specification
// - 3GPP TS 23.003: Numbering, addressing and identification
// - 3GPP TS 23.401: GPRS enhancements for E-UTRAN access
// - 3GPP TS 33.210: Network Domain Security (NDS)
// - RFC 6733: Diameter Base Protocol
// - RFC 5778: Diameter Mobile IPv6 (defines Service-Selection)
//
// ================================================================================
